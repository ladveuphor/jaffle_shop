semantic_models:
  - name: fct_customer_orders
    description: |
      Analysis of customer orders.
    model: ref('fct_customer_orders')
    defaults:
      agg_time_dimension: order_date

    entities:
      - name: order
        type: primary
        expr: order_id

    measures:
      - name: sum_total_amount_paid
        description: The count of total amount paid of the order.
        agg: SUM
        expr: total_amount_paid
        agg_time_dimension: order_date

    dimensions:
      - name: order_date
        type: time
        description: Date at which the order was placed.
        expr: order_placed_at
        type_params:
          time_granularity: day 

metrics:
  - name: total_revenue
    description: Total revenue generated by customer orders.
    type: simple
    label: total_revenue
    type_params:
      measure: sum_total_amount_paid

# mf query --metrics total_revenue --group-by order__order_date__day